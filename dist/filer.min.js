/*! (c) 2017 Copyright (c) 2016 Eric Bidelman. All rights reserved.

 * @version v0.4.5 (Apache) */
var FileError,$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");self.URL=self.URL||self.webkitURL;self.requestFileSystem=self.requestFileSystem||self.webkitRequestFileSystem;
self.resolveLocalFileSystemURL=self.resolveLocalFileSystemURL||self.webkitResolveLocalFileSystemURL;navigator.temporaryStorage=navigator.temporaryStorage||navigator.webkitTemporaryStorage;navigator.persistentStorage=navigator.persistentStorage||navigator.webkitPersistentStorage;self.BlobBuilder=self.BlobBuilder||self.MozBlobBuilder||self.WebKitBlobBuilder;debugger;
if(void 0===self.FileError||self.FileError&&self.FileError.NOT_FOUND_ERR)FileError=function(){},self.DOMException&&self.DOMException.NOT_FOUND_ERR?FileError=DOMException:FileError.prototype.prototype=Error.prototype;
var Util={toArray:function(a){return Array.prototype.slice.call(a||[],0)},strToDataURL:function(a,b,c){return(void 0!=c?c:1)?"data:"+b+";base64,"+self.btoa(a):"data:"+b+","+a},strToObjectURL:function(a,b){for(var c=new Uint8Array(a.length),d=0;d<c.length;++d)c[d]=a.charCodeAt(d);a=new Blob([c],b?{type:b}:{});return self.URL.createObjectURL(a)},fileToObjectURL:function(a){return self.URL.createObjectURL(a)},fileToArrayBuffer:function(a,b,c){var d=new FileReader;d.onload=function(a){b(a.target.result)};
d.onerror=function(a){c&&c(a)};d.readAsArrayBuffer(a)},dataURLToBlob:function(a){if(-1==a.indexOf(";base64,")){var b=a.split(",");a=b[0].split(":")[1];b=decodeURIComponent(b[1]);return new Blob([b],{type:a})}b=a.split(";base64,");a=b[0].split(":")[1];b=window.atob(b[1]);for(var c=b.length,d=new Uint8Array(c),f=0;f<c;++f)d[f]=b.charCodeAt(f);return new Blob([d],{type:a})},arrayBufferToBlob:function(a,b){a=new Uint8Array(a);return new Blob([a],b?{type:b}:{})},arrayBufferToBinaryString:function(a,b,
c){var d=new FileReader;d.onload=function(a){b(a.target.result)};d.onerror=function(a){c&&c(a)};a=new Uint8Array(a);d.readAsBinaryString(new Blob([a]))},arrayToBinaryString:function(a){if("object"!=typeof a)return null;for(var b=a.length,c=Array(b);b--;)c[b]=String.fromCharCode(a[b]);return c.join("")},getFileExtension:function(a){var b=a.lastIndexOf(".");return-1!=b?a.substring(b):""}},MyFileError=function(a){this.prototype=FileError.prototype;this.code=a.code;this.name=a.name};
FileError.BROWSER_NOT_SUPPORTED=1E3;FileError.prototype.__defineGetter__("name",function(){for(var a=Object.keys(FileError),b=0,c;c=a[b];++b)if(FileError[c]==this.code)return c;return"Unknown Error"});
var Filer=new function(){function a(a){if(b=a||null)c=b.root,d=!0}var b=null,c=null,d=!1,f=function(a){0!=a.indexOf("filesystem:")&&(a="/"==a[0]?b.root.toURL()+a.substring(1):0==a.indexOf("./")||0==a.indexOf("../")?"../"==a&&c!=b.root?c.toURL()+"/"+a:c.toURL()+a:c.toURL()+"/"+a);return a},l=function(a,b,c){var e=arguments[2],h=arguments[3],g=b||function(a){throw a;},d=function(a){var b=a.code==FileError.NOT_FOUND_ERR?h?Error('"'+e+'" or "'+h+'" does not exist.'):Error('"'+e+'" does not exist.'):Error("Problem getting Entry for one or more paths.");
b.code=a.code;g(b)},p=f(e);if(4==arguments.length){var r=f(h);self.resolveLocalFileSystemURL(p,function(b){self.resolveLocalFileSystemURL(r,function(e){a(b,e)},d)},d)}else self.resolveLocalFileSystemURL(p,a,d)},q=function(a,c,g,k,d,n){if(!b)throw Error("Filesystem has not been initialized.");if(typeof a!=typeof c)throw Error("These method arguments are not supported.");var e=g||null,h=void 0!=n?n:!1;(a.isFile||c.isDirectory)&&c.isDirectory?h?a.moveTo(c,e,k,d):a.copyTo(c,e,k,d):l(function(a,b){if(b.isDirectory)h?
a.moveTo(b,e,k,d):a.copyTo(b,e,k,d);else if(a=Error('Oops! "'+b.name+" is not a directory!"),d)d(a);else throw a;},d,a,c)};a.DEFAULT_FS_SIZE=1048576;a.version="0.4.3";a.prototype={get fs(){return b},get isOpen(){return d},get cwd(){return c}};a.prototype.pathToFilesystemURL=function(a){return f(a)};a.prototype.init=function(a,h,g){if(!self.requestFileSystem)throw new MyFileError({code:FileError.BROWSER_NOT_SUPPORTED,name:"BROWSER_NOT_SUPPORTED"});a=a?a:{};var e=a.size||1048576;this.type=self.TEMPORARY;
"persistent"in a&&a.persistent&&(this.type=self.PERSISTENT);var m=function(a){this.size=e;b=a;c=b.root;d=!0;h&&h(a)};this.type==self.PERSISTENT&&navigator.persistentStorage?navigator.persistentStorage.requestQuota(e,function(a){self.requestFileSystem(this.type,a,m.bind(this),g)}.bind(this),g):self.requestFileSystem(this.type,e,m.bind(this),g)};a.prototype.ls=function(a,d,g){if(!b)throw Error("Filesystem has not been initialized.");var e=function(a){c=a;var b=[],e=c.createReader(),h=function(){e.readEntries(function(a){a.length?
(b=b.concat(Util.toArray(a)),h()):(b.sort(function(a,b){return a.name<b.name?-1:b.name<a.name?1:0}),d(b))},g)};h()};a.isDirectory?e(a):0==a.indexOf("filesystem:")?l(e,g,a):c.getDirectory(a,{},e,g)};a.prototype.mkdir=function(a,d,g,k){if(!b)throw Error("Filesystem has not been initialized.");var e=null!=d?d:!1,h=a.split("/"),f=function(b,c){if("."==c[0]||""==c[0])c=c.slice(1);b.getDirectory(c[0],{create:!0,exclusive:e},function(b){if(b.isDirectory)c.length&&1!=h.length?f(b,c.slice(1)):g&&g(b);else if(b=
Error(a+" is not a directory"),k)k(b);else throw b;},function(b){if(b.code==FileError.INVALID_MODIFICATION_ERR)if(b.message="'"+a+"' already exists",k)k(b);else throw b;})};f(c,h)};a.prototype.open=function(a,c,d){if(!b)throw Error("Filesystem has not been initialized.");a.isFile?a.file(c,d):l(function(a){a.file(c,d)},d,f(a))};a.prototype.create=function(a,d,g,k){if(!b)throw Error("Filesystem has not been initialized.");c.getFile(a,{create:!0,exclusive:null!=d?d:!0},g,function(b){b.code==FileError.INVALID_MODIFICATION_ERR&&
(b.message="'"+a+"' already exists");if(k)k(b);else throw b;})};a.prototype.mv=function(a,b,c,d,f){q.bind(this,a,b,c,d,f,!0)()};a.prototype.rm=function(a,c,d){if(!b)throw Error("Filesystem has not been initialized.");var e=function(a){a.isFile?a.remove(c,d):a.isDirectory&&a.removeRecursively(c,d)};a.isFile||a.isDirectory?e(a):l(e,d,a)};a.prototype.cd=function(a,d,g){if(!b)throw Error("Filesystem has not been initialized.");a.isDirectory?(c=a,d&&d(c)):(a=f(a),l(function(a){if(a.isDirectory)c=a,d&&
d(c);else if(a=Error("Path was not a directory."),g)g(a);else throw a;},g,a))};a.prototype.cp=function(a,b,c,d,f){q.bind(this,a,b,c,d,f)()};a.prototype.write=function(a,d,g,f){if(!b)throw Error("Filesystem has not been initialized.");var e=function(a){a.createWriter(function(b){b.onerror=f;if(d.append)b.onwriteend=function(b){g&&g(a,this)},b.seek(b.length);else{var c=!1;b.onwriteend=function(b){c?g&&g(a,this):(c=!0,this.truncate(this.position))}}d.data.__proto__==ArrayBuffer.prototype&&(d.data=new Uint8Array(d.data));
var e=new Blob([d.data],d.type?{type:d.type}:{});b.write(e)},f)};a.isFile?e(a):0==a.indexOf("filesystem:")?l(e,f,a):c.getFile(a,{create:!0,exclusive:!1},e,f)};a.prototype.df=function(a,b){var c=function(b,c){a(b,c-b,c)};if(!navigator.temporaryStorage.queryUsageAndQuota||!navigator.persistentStorage.queryUsageAndQuota)throw Error("Not implemented.");self.TEMPORARY==this.type?navigator.temporaryStorage.queryUsageAndQuota(c,b):self.PERSISTENT==this.type&&navigator.persistentStorage.queryUsageAndQuota(c,
b)};return a};"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(module.exports=Filer),exports.Filer=Filer);